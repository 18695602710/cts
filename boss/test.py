# import telnetlib
# try:
#   telnetlib.Telnet('180.168.13.26', port='8000', timeout=10)
# except:
#   print('connect failed')
# else:
#   print('success')
import requests,re
from bs4 import BeautifulSoup
ip_list = ['http://218.249.45.162:52316','http://221.178.232.130:8080','http://47.94.200.124:3128',
'http://111.160.169.54:37890','http://116.62.134.173:9999','http://59.63.158.44:80',
'http://60.205.202.3:3128','http://118.187.58.34:53281','http://47.107.175.190:8000',
'http://103.38.4.246:49356','http://222.95.9.93:8080','http://112.14.47.6:52024',
'http://120.132.52.6:8888','http://117.191.11.76:80','http://116.196.90.176:3128',
'http://203.130.46.108:9090','http://220.175.132.222:8060','http://117.191.11.113:8080',
'http://119.23.238.202:3128','http://115.224.141.145:8118','http://119.190.188.68:8060',
'http://115.159.31.195:8080','http://139.199.153.25:1080','http://59.44.247.194:9797',
'http://49.51.195.24:1080','http://101.231.234.38:8080','http://62.201.221.93:8080',
'http://27.203.241.132:8060','http://116.114.19.211:443','http://117.191.11.104:80',
'http://113.207.69.68:80','http://117.191.11.111:8080','http://112.247.177.90:8060',
'http://60.217.73.238:8060','http://183.57.36.87:8888','http://125.73.220.18:49128',
'http://103.205.26.78:54986','http://125.67.25.83:56181','http://218.22.7.62:53281',
'http://123.52.43.64:8118','http://111.231.12.253:1080','http://221.5.80.66:3128',
'http://60.10.2.70:3128','http://27.208.93.6:8060','http://112.247.177.164:8060',
'http://120.26.208.102:88','http://112.84.178.21:8888','http://182.92.169.109:3128',
'http://182.35.87.108:9999','http://113.121.22.228:9999','http://117.191.11.108:80',
'http://218.241.219.226:9999','http://60.205.188.24:3128','http://123.139.56.238:9999',
'http://183.146.213.157:80','http://27.188.62.55:8060','http://103.205.14.65:8080',
'http://180.150.191.150:8888','http://27.203.215.58:8060','http://112.35.56.134:80',
'http://120.234.63.196:3128','http://106.75.8.141:808','http://120.132.52.248:8888',
'http://120.132.52.79:8888','http://27.208.89.118:8060','http://103.38.5.65:49356',
'http://182.35.82.217:9999','http://14.20.235.184:808','http://120.78.141.110:3128',
'http://182.61.160.79:80','http://103.1.92.237:8080','http://210.26.64.44:3128',
'http://180.104.107.46:45700','http://39.137.69.6:8080','http://123.207.17.166:80',
'http://183.245.98.6:8118','http://120.210.219.74:8080','http://113.121.42.143:61234',
'http://36.25.243.251:80','http://118.24.89.122:1080','http://123.7.14.63:3128',
'http://117.191.11.109:80','http://58.220.95.84:9401','http://222.223.182.66:8000',
'http://59.37.33.62:50686','http://47.104.138.238:8080','http://47.106.140.89:8080',
'http://47.93.18.195:80','http://182.61.172.231:3128','http://124.172.232.49:8010',
'http://217.182.120.162:1080','http://101.37.20.241:443','http://111.59.90.238:80',
'http://103.235.199.93:47373','http://222.85.28.130:52590','http://120.132.52.137:8888',
'http://1.199.31.42:9999','http://119.139.199.162:3128','http://117.191.11.110:8080','http://27.208.64.4:8060']
success_list = []
url = 'http://ip.chinaz.com/'
headers = {'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/74.0.3729.169 Safari/537.36'
}
for i in ip_list:
    print('i:{}'.format(i))
    protocol = re.findall('(\w+)://',i)
    proxies = {protocol[0]:i}
    print('proxies is {}'.format(proxies))
    # r = requests.get(url, headers=headers, proxies=proxies)
    # soup = BeautifulSoup(r.text, 'lxml')
    # parent_node = soup.find(class_="IpMRig-tit")
    # for i in parent_node.find_all('dd'):
    #     print(i.get_text())
    try:
        response = requests.get('http://ip.chinaz.com/', headers=headers,  proxies=proxies, timeout=5)
        soup = BeautifulSoup(response.text, 'lxml')
        parent_node = soup.find(class_="IpMRig-tit")
        for j in parent_node.find_all('dd'):
             print(j.get_text())
    except:
        print('connect failed')
    else:
        print('success')
        success_list.append(i)
print(success_list)

